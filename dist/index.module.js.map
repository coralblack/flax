{"mappings":"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","sources":["./src/utils.ts","./src/components/FxNotification.tsx","./src/components/FxNotificationContainer.tsx","./src/request.ts","./src/hooks/useRequest.ts","./src/components/FxButton.tsx","./src/components/FxGuard.tsx"],"sourcesContent":["export function classNames(\n  ...args: Array<\n    string | boolean | {[key: string]: boolean | undefined} | undefined | null\n  >\n): string {\n  return args\n    .reduce<Array<string>>((o, e) => {\n      if (typeof e === 'string' && e) o.push(e);\n      else if (Array.isArray(e)) o.push(classNames(e));\n      else if (e && typeof e === 'object') {\n        Object.keys(e).forEach(k => {\n          if (e[k]) o.push(k);\n        });\n      }\n\n      return o;\n    }, [])\n    .join(' ');\n}\n","import React, {useCallback, useEffect, useState} from 'react';\nimport ReactDOM, {render} from 'react-dom';\nimport {useNotificationContainer} from './FxNotificationContainer';\nimport {classNames} from '../utils';\n\nexport type FxNotificationType = 'SUCC' | 'WARN' | 'ERROR' | 'INFO';\nexport interface FxNotificationPayload {\n  type?: FxNotificationType;\n  title?: string;\n  message: string;\n}\nexport interface FxNotificationAttrs extends FxNotificationPayload {\n  delay?: number;\n}\nexport type FxNotificationToast = string | FxNotificationPayload;\n\ninterface UseNotificationProps {}\ninterface UseNotification {\n  container: HTMLElement;\n  alert: (attrs: FxNotificationPayload) => void;\n}\n\ninterface ProgressBar {\n  pause: () => void;\n  resume: () => void;\n  done: () => void;\n}\n\nfunction Progress(\n  callback: () => void,\n  elem: HTMLSpanElement,\n  delay: number\n): ProgressBar {\n  let timerId = setTimeout(callback, delay);\n  let remaining = delay;\n  let start = new Date().getTime();\n\n  const anim = () => {\n    const prev = ((delay - remaining) / delay) * 100;\n\n    if (elem) {\n      elem.style.width =\n        String(\n          prev + ((new Date().getTime() - start) / remaining) * (100 - prev)\n        ) + '%';\n    }\n  };\n\n  let animInterval = setInterval(anim, 5);\n\n  return {\n    pause() {\n      clearTimeout(timerId);\n      clearInterval(animInterval);\n      remaining -= new Date().getTime() - start;\n    },\n    resume() {\n      start = new Date().getTime();\n\n      clearTimeout(timerId);\n      clearInterval(animInterval);\n\n      timerId = setTimeout(callback, remaining);\n      animInterval = setInterval(anim, 5);\n    },\n    done() {\n      clearTimeout(timerId);\n      clearInterval(animInterval);\n    },\n  };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function useNotification(props: UseNotificationProps): UseNotification {\n  const {container} = useNotificationContainer();\n\n  return {\n    container,\n    alert: (attrs: FxNotificationAttrs) => {\n      const {delay, ...props} = attrs;\n      const wrapper = document.createElement('div');\n      wrapper.classList.add('fx-notification-wrapper');\n      container.appendChild(wrapper);\n      render(<FxNotification {...props} />, wrapper, () => {\n        const closeButton = wrapper.getElementsByTagName('button');\n        const progressBar = wrapper.getElementsByTagName('span');\n\n        let progress: ProgressBar | undefined = undefined;\n\n        const cb = () => {\n          wrapper.classList.add('--hide');\n          !!progress && progress.done();\n\n          setTimeout(() => {\n            ReactDOM.unmountComponentAtNode(wrapper);\n            wrapper.remove();\n          }, 450);\n        };\n\n        closeButton[0]?.addEventListener('click', () => {\n          cb();\n        });\n\n        progress = Progress(cb, progressBar[0], Math.min(delay || 5000, 5000));\n\n        wrapper.addEventListener('mouseover', () => {\n          !!progress && progress.pause();\n        });\n\n        wrapper.addEventListener('mouseout', () => {\n          !!progress && progress.resume();\n        });\n      });\n    },\n  };\n}\n\nfunction Type(type: FxNotificationType) {\n  if (!type || type === 'INFO') return null;\n\n  return (\n    <>\n      <div className=\"--icon\">\n        {type === 'SUCC' && (\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M5 13l4 4L19 7\"\n            />\n          </svg>\n        )}\n        {type === 'WARN' && (\n          <>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n              />\n            </svg>\n          </>\n        )}\n        {type === 'ERROR' && (\n          <>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n          </>\n        )}\n      </div>\n    </>\n  );\n  //if (type === 'WARN') return <div>W</div>;\n  //if (type === 'ERROR') return <div>E</div>;\n}\n\ninterface FxNotificationProps extends FxNotificationPayload {}\n\nexport function FxNotification(props: FxNotificationProps) {\n  const {type, title, message} = props;\n\n  useEffect(() => {\n    // Initialize\n\n    return () => {\n      // Clear\n    };\n  });\n\n  return (\n    <>\n      <div\n        className={classNames(\n          'flax fx-notification',\n          `--${(type || 'info').toLocaleLowerCase()}`\n        )}\n      >\n        {type && Type(type)}\n        {title && <strong>{title}</strong>}\n        {message}\n        <button className=\"close\">Close</button>\n        <div className=\"progress\">\n          <span />\n        </div>\n      </div>\n    </>\n  );\n}\n","interface UseNotificationContainer {\n  container: HTMLElement;\n}\n\nconst fxNotificationContainerId = 'fx-notification-container';\nexport function useNotificationContainer(): UseNotificationContainer {\n  const container =\n    document.getElementById(fxNotificationContainerId) ||\n    (() => {\n      const dom = document.createElement('div');\n      dom.id = fxNotificationContainerId;\n      dom.classList.add('flax');\n      dom.classList.add('fx-notification-container');\n      document.body.appendChild(dom);\n\n      return dom;\n    })();\n\n  return {\n    container,\n  };\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport axios, {AxiosError, AxiosResponse, ResponseType} from 'axios';\nimport NodeCache from 'node-cache';\nimport PCancelable from 'p-cancelable';\nimport queryString from 'query-string';\nimport {MutableRefObject} from 'react';\nimport {FxNotificationToast} from './components/FxNotification';\n\nconst cache = new NodeCache({maxKeys: 100});\n\nexport type Notifiable = FxNotificationToast | any;\nexport type DoneDelegate<T> = (\n  res: T | null,\n  error: Error | null,\n  resp?: AxiosResponse | null\n) => Notifiable;\nexport type SucceedDelegate<T> = (data: T, resp: AxiosResponse) => Notifiable;\nexport type ErrorDelegate<T> = (data: T, error: AxiosResponse<T>) => Notifiable;\n\nexport type QueryType = string | number | bigint | boolean;\nexport type Queries = {[key: string]: QueryType | QueryType[]};\nexport type Headers = {[key: string]: string};\ntype DataPrimTypes = string | number | bigint | boolean | null;\ntype DataObjTypes = Array<DataPrimTypes> | {[key: string]: DataPrimTypes};\ntype DataTypeValues =\n  | DataPrimTypes\n  | DataObjTypes\n  | {[key: string]: DataObjTypes}\n  | Array<DataObjTypes>;\nexport type DataType = {\n  [key: string]:\n    | DataTypeValues\n    | MutableRefObject<HTMLElement | null>\n    | DataType;\n};\nexport type Data = DataType | (() => DataType) | string;\n\nexport type FxResp<T, TR> = {data: T; reduced: TR; response: AxiosResponse<T>};\n\ninterface FxErrorResponse<T, TR> extends AxiosResponse<T> {\n  reduced: TR;\n}\n\nexport interface FxError<T, TR> extends AxiosError<T> {\n  response?: FxErrorResponse<T, TR>;\n}\n\nexport interface FxApiRequest<TR = any, TE = any, TRR = TR, TER = TE> {\n  method: 'GET' | 'POST' | 'DELETE' | 'PATCH' | 'PUT';\n  url: string;\n  cacheMaxAge?: number;\n  throttle?: boolean;\n  delay?: number;\n  responseType?: ResponseType;\n  query?: Queries;\n  headers?: Headers;\n  data?: Data;\n  reducer?: (data: TR) => TRR;\n  errReducer?: (data: TE, error: AxiosError<TE>) => TER;\n}\n\ninterface RequestProps<TR, TE, TRR, TER>\n  extends FxApiRequest<TR, TE, TRR, TER> {\n  refreshId?: number;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Resolver = (data: any) => void;\ntype Rejector = (reason: Error) => void;\ntype Canceller = () => void;\n\nconst resolving = (\n  resolve: Resolver,\n  reject: Rejector,\n  props: RequestProps<any, any, any, any>,\n  resp: AxiosResponse | null,\n  error: FxError<any, any> | null\n) => {\n  if (error) {\n    if (error.response?.data) {\n      if (props.errReducer) {\n        error.response.reduced = props.errReducer(error.response?.data, error);\n      } else {\n        error.response.reduced = error.response?.data;\n      }\n    }\n\n    reject(error);\n  } else {\n    resolve({\n      data: resp?.data,\n      reduced: props.reducer ? props.reducer(resp?.data) : resp?.data,\n      response: resp,\n    });\n  }\n};\n\nconst resolvers: {\n  [key: string]: Array<{\n    resolve: Resolver;\n    reject: Rejector;\n    cancel: Canceller;\n    props: RequestProps<any, any, any, any>;\n  }>;\n} = {};\n\nconst resolver = (\n  resolver: {\n    resolve: Resolver;\n    reject: Rejector;\n    cancelled: boolean;\n    props: RequestProps<any, any, any, any>;\n  },\n  key: string | null,\n  resp: AxiosResponse | null,\n  error: FxError<any, any> | null,\n  startAt: Date,\n  cacheKey: string | null\n) => {\n  if (cacheKey && resolver.props.cacheMaxAge) {\n    cache.set(cacheKey, {data: resp?.data}, resolver.props.cacheMaxAge);\n  }\n\n  if (!key) {\n    const delay =\n      (resolver.props.delay || 0) - (new Date().getTime() - startAt.getTime());\n\n    setTimeout(() => {\n      resolving(resolver.resolve, resolver.reject, resolver.props, resp, error);\n    }, Math.max(delay, 0));\n    return;\n  }\n\n  const res = resolvers[key].splice(0, resolvers[key].length);\n\n  res.forEach(({resolve, reject, props}) => {\n    const delay =\n      (props.delay || 0) - (new Date().getTime() - startAt.getTime());\n\n    setTimeout(() => {\n      resolving(resolve, reject, props, resp, error);\n    }, Math.max(delay, 0));\n  });\n};\n\nconst dataMapper = (data: DataType | string | null | undefined) => {\n  if (!data) return data;\n  if (typeof data !== 'object') return data;\n  if (Array.isArray(data)) return data;\n\n  return Object.keys(data).reduce<{[key: string]: any}>((p, c) => {\n    if (typeof data[c] === 'object' && data[c] !== null) {\n      if ((data[c] as any).current instanceof HTMLElement) {\n        p[c] = (data[c] as any).current.value;\n      } else {\n        p[c] = dataMapper(data[c] as any);\n      }\n    } else if (typeof data[c] === 'bigint') {\n      p[c] = String(data[c]);\n    } else {\n      p[c] = data[c];\n    }\n    return p;\n  }, {});\n};\n\nexport function setDefaultHeaders(headers: {[key: string]: string}) {\n  axios.defaults.headers.common = Object.assign(\n    axios.defaults.headers.common,\n    headers\n  );\n}\n\nexport function setBaseUrl(url: string) {\n  axios.defaults.baseURL = url;\n}\n\nexport function setDefaultTransformResponse(trs: Array<(data: any) => any>) {\n  axios.defaults.transformResponse = trs;\n}\n\nexport function request<TR, TE, TRR, TER>(\n  props: RequestProps<TR, TE, TRR, TER>\n): PCancelable<FxResp<TR, TRR>> {\n  const cp = new PCancelable<FxResp<TR, TRR>>((resolve, reject, onCancel) => {\n    const cancel = () => {\n      cp.cancel();\n    };\n    const ct = axios.CancelToken.source();\n\n    const url = ((u, query) => {\n      const qs = queryString.stringify(query);\n      return u + (qs ? (u.includes('?') ? '&' : '?') + qs : '');\n    })(props.url, props.query || {});\n\n    const lazyGroup =\n      props.method === 'GET' && props.throttle\n        ? `${props.method} ${url} ${props.delay || 0}`\n        : null;\n\n    const cacheKey =\n      props.method === 'GET' && props.cacheMaxAge && props.cacheMaxAge > 0\n        ? `${props.method} ${props.url} ${props.cacheMaxAge}`\n        : null;\n    const cached = cacheKey && cache.get(cacheKey);\n\n    if (cached) {\n      resolver(\n        {resolve, reject, cancelled: false, props},\n        null,\n        cached as AxiosResponse,\n        null,\n        new Date(),\n        null\n      );\n      return;\n    }\n\n    onCancel.shouldReject = false;\n    onCancel(() => {\n      if (!lazyGroup || resolvers[lazyGroup].length === 1) {\n        ct.cancel();\n      }\n    });\n\n    setTimeout(() => {\n      if (lazyGroup) {\n        resolvers[lazyGroup] = resolvers[lazyGroup] || [];\n        resolvers[lazyGroup].push({resolve, reject, cancel, props});\n\n        // Duplicated `GET` request,\n        if (resolvers[lazyGroup].length > 1) {\n          return;\n        }\n      }\n\n      const start = new Date();\n\n      axios\n        .request<TR>({\n          cancelToken: ct.token,\n          method: props.method,\n          url,\n          headers: props.headers,\n          responseType: props.responseType,\n          data: dataMapper(\n            typeof props.data === 'function' ? props.data() : props.data\n          ),\n        })\n        .then(resp => {\n          resolver(\n            {resolve, reject, cancelled: cp.isCanceled, props},\n            lazyGroup,\n            resp,\n            null,\n            start,\n            cacheKey\n          );\n        })\n        .catch(err => {\n          resolver(\n            {resolve, reject, cancelled: cp.isCanceled, props},\n            lazyGroup,\n            null,\n            err,\n            start,\n            null\n          );\n        });\n    }, 25);\n  });\n\n  return cp;\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport PCancelable from 'p-cancelable';\nimport {useState} from 'react';\nimport {\n  FxNotificationType,\n  useNotification,\n} from '../components/FxNotification';\nimport {\n  Data,\n  DoneDelegate,\n  ErrorDelegate,\n  FxApiRequest,\n  Notifiable,\n  Queries,\n  Headers,\n  request,\n  SucceedDelegate,\n} from '../request';\n\nexport interface UseRequestProps<TR, TE, TRR = TR, TER = TE> {\n  done?: DoneDelegate<TR>;\n  success?: SucceedDelegate<TRR>;\n  error?: ErrorDelegate<TER>;\n}\n\nexport const notify = (payload: Notifiable, type: FxNotificationType) => {\n  if (!payload) return;\n  if (typeof payload === 'string') {\n    payload = {\n      message: payload,\n    };\n  }\n\n  if (!payload.message) return;\n  payload.type = payload.type || type;\n\n  if (type === 'WARN' || type === 'ERROR') {\n    payload.delay = payload.delay || 10000;\n  }\n\n  const {alert: notiAlert} = useNotification({});\n  notiAlert(payload);\n};\n\nexport function useRequest<TR = any, TE = any, TRR = TR, TER = TE>(\n  api: FxApiRequest<TR, TE, TRR, TER>,\n  props?: UseRequestProps<TR, TE, TRR, TER>\n) {\n  const [reqId, setReqId] = useState(0);\n  const [resp, setResp] = useState<{\n    busy: boolean;\n    response: TRR | undefined;\n    errorResponse: TER | undefined;\n  }>({busy: false, response: undefined, errorResponse: undefined});\n\n  const {success, done, error} = props || {};\n  const queues: Array<PCancelable<any>> = [];\n\n  const requestWrapper = (wrapperParams?: {\n    data?: Data;\n    query?: Queries;\n    headers?: Headers;\n  }): boolean => {\n    if (resp.busy) return false;\n\n    setResp({\n      busy: true,\n      response: undefined,\n      errorResponse: undefined,\n    });\n\n    const reqParams = {...api};\n\n    if (wrapperParams?.data) {\n      reqParams.data = wrapperParams.data;\n    }\n    if (wrapperParams?.query) {\n      reqParams.query = wrapperParams?.query;\n    }\n    if (wrapperParams?.headers) {\n      reqParams.headers = wrapperParams?.headers;\n    }\n\n    const rp = request<TR, TE, TRR, TER>(reqParams);\n\n    rp.then(res => {\n      notify(success && success(res.reduced, res.response), 'SUCC');\n      notify(done && done(res.data, null, res.response), 'INFO');\n\n      setReqId(reqId + 1);\n      setResp({\n        busy: false,\n        response: res.reduced,\n        errorResponse: undefined,\n      });\n    }).catch(err => {\n      const type =\n        typeof err.response?.status === 'number' && err.response?.status < 500\n          ? 'WARN'\n          : 'ERROR';\n      notify(error && error(err.response?.reduced || err, err), type);\n      notify(done && done(err.response?.data, err, err.response), type);\n\n      setReqId(reqId + 1);\n      setResp({\n        busy: false,\n        response: err.response?.reduced,\n        errorResponse: undefined,\n      });\n    });\n\n    queues.push(rp);\n\n    return true;\n  };\n\n  const cancel = () => {\n    let rp;\n\n    while ((rp = queues.pop())) {\n      rp.cancel();\n    }\n  };\n\n  return {\n    reqId,\n    request: requestWrapper,\n    response: resp,\n    cancel,\n  };\n}\n","import React, {Component, ReactNode} from 'react';\nimport {FxNotificationType} from './FxNotification';\nimport {notify} from '../hooks/useRequest';\nimport {\n  DoneDelegate,\n  ErrorDelegate,\n  FxApiRequest,\n  Notifiable,\n  request,\n  SucceedDelegate,\n} from '../request';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\ninterface FxButtonProps<TR, TE, TRR, TER> {\n  tag?: string;\n  children?: ReactNode;\n  className?: string;\n  label?: string;\n\n  api: FxApiRequest<TR, TE, TRR, TER>;\n  done?: DoneDelegate<TR>;\n  success?: SucceedDelegate<TRR>;\n  error?: ErrorDelegate<TER>;\n}\n\ninterface FxButtonStates {\n  busy: boolean;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport class FxButton<TR = any, TE = any, TRR = TR, TER = TE> extends Component<\n  FxButtonProps<TR, TE, TRR, TER>,\n  FxButtonStates\n> {\n  constructor(props: FxButtonProps<TR, TE, TRR, TER>) {\n    super(props);\n\n    this.state = {\n      busy: false,\n    };\n  }\n\n  private noti(payload: Notifiable, type: FxNotificationType) {\n    notify(payload, type);\n  }\n\n  handleClick() {\n    if (this.state.busy) return;\n\n    this.setState({...this.state, busy: true});\n\n    const {success, error, done} = this.props;\n\n    request<TR, TE, TRR, TER>({...this.props.api})\n      .then(res => {\n        this.noti(success && success(res.reduced, res.response), 'SUCC');\n        this.noti(done && done(res.data, null, res.response), 'INFO');\n        this.setState({...this.state, busy: false});\n      })\n      .catch(err => {\n        const type =\n          typeof err.response?.status === 'number' && err.response?.status < 500\n            ? 'WARN'\n            : 'ERROR';\n        this.noti(error && error(err.response?.reduced, err), type);\n        this.noti(done && done(err.response?.data, err, err.response), type);\n        this.setState({...this.state, busy: false});\n      });\n  }\n\n  render() {\n    const ButtonTag = `${\n      this.props.tag || 'button'\n    }` as keyof JSX.IntrinsicElements;\n\n    return (\n      <ButtonTag\n        className={`flax fx-button ${this.state.busy ? '--busy' : ''} ${\n          this.props.className || ''\n        }`}\n        onClick={() => this.handleClick()}\n        disabled={this.state.busy}\n      >\n        {this.props.children || this.props.label}\n      </ButtonTag>\n    );\n  }\n}\n","import PCancelable from 'p-cancelable';\nimport React, {Component, Suspense, useEffect, useState} from 'react';\nimport {request, FxApiRequest, FxResp, FxError} from '../request';\nimport {classNames} from '../utils';\n\ntype Renderer<T> = (data: T | null, reloaded?: boolean) => React.ReactNode;\ntype ErrorRenderer<T, TR> = (\n  data: TR | null,\n  error: FxError<T, TR>\n) => React.ReactNode;\ntype LoadingRenderer = () => React.ReactNode;\n\ntype LazyStatus = 'PENDING' | 'SUCCESS' | 'ERROR';\ninterface Lazy<TR, TE, TRR = TR, TER = TE> {\n  status: LazyStatus;\n  error: FxError<TE, TER> | null;\n  result: FxResp<TR, TRR> | null;\n}\n\ntype LazyResponse<TR, TE, TRR, TER> = {\n  status: LazyStatus;\n  result: FxResp<TR, TRR> | null;\n  error: FxError<TE, TER> | null;\n};\n\nfunction lazyResponse<TR, TE, TRR, TER>(\n  result: FxResp<TR, TRR> | null,\n  error: FxError<TE, TER> | null\n): () => LazyResponse<TR, TE, TRR, TER> {\n  return () => ({\n    status: error ? 'ERROR' : 'SUCCESS',\n    result,\n    error,\n  });\n}\n\nconst lazy = function <TR, TE, TRR = TR, TER = TE>(\n  release: ReleaseDelegateInternal,\n  p: PCancelable<FxResp<TR, TRR>>\n) {\n  let status: LazyStatus = 'PENDING';\n  let error: FxError<TE, TER> | null;\n  let result: FxResp<TR, TRR> | null;\n\n  p.then(res => {\n    if (p.isCanceled) return;\n    ({result, status, error} = lazyResponse<TR, TE, TRR, TER>(res, null)());\n    release(true);\n  }).catch(err => {\n    if (p.isCanceled) return;\n    ({result, status, error} = lazyResponse<TR, TE, TRR, TER>(null, err)());\n    release(false);\n  });\n\n  return (): Lazy<TR, TE, TRR, TER> => {\n    if (status === 'PENDING') throw p;\n\n    return {\n      status,\n      error,\n      result,\n    };\n  };\n};\n\ninterface FxGuardInnerProps<TR, TE, TRR, TER>\n  extends FxGuardProps<TR, TE, TRR, TER> {\n  releaseBusy: ReleaseDelegateInternal;\n  refreshId: number;\n  reloadId: number;\n}\n\nfunction FxGuardInner<TR, TE, TRR, TER>(\n  props: FxGuardInnerProps<TR, TE, TRR, TER>\n) {\n  const [prepared, setPrepared] = useState<\n    () => LazyResponse<TR, TE, TRR, TER>\n  >();\n  const {api, refreshId, reloadId, error, naked} = props;\n  const req = () => {\n    return request<TR, TE, TRR, TER>(\n      Object.assign(\n        {\n          throttle: api.throttle === false ? false : true,\n          refreshId,\n        },\n        props.api,\n        {\n          reducer: undefined,\n          errReducer: undefined,\n        }\n      )\n    );\n  };\n\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let rp: PCancelable<any> | undefined = undefined;\n\n    if (reloadId > 0) {\n      rp = req();\n\n      rp.then(res => {\n        if (rp?.isCanceled) return;\n\n        setPrepared(() => lazyResponse<TR, TE, TRR, TER>(res, null));\n        props.releaseBusy(true);\n      }).catch(err => {\n        if (rp?.isCanceled) return;\n\n        setPrepared(() => lazyResponse<TR, TE, TRR, TER>(null, err));\n        props.releaseBusy(false);\n      });\n    }\n\n    return () => {\n      if (rp) {\n        rp.cancel();\n      }\n    };\n  }, [reloadId]);\n\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let rp: PCancelable<any> | undefined = undefined;\n\n    setPrepared(() => {\n      rp = req();\n\n      return lazy<TR, TE, TRR, TER>(props.releaseBusy, rp);\n    });\n\n    return () => {\n      if (rp) {\n        rp.cancel();\n      }\n    };\n  }, [api.method, api.url, refreshId]);\n\n  if (!prepared) return <></>;\n\n  const resp = prepared();\n\n  if (resp.status === 'ERROR') {\n    const rr = () => {\n      if (!resp.error?.response?.data) return null;\n      return props.api.errReducer\n        ? props.api.errReducer(resp.error?.response.data, resp.error)\n        : resp.error?.response.data;\n    };\n\n    const r = () => (\n      <>\n        {error && error(rr() as TER, resp.error!)}\n        {!error && <div>Error ({resp.error?.message})</div>}\n      </>\n    );\n\n    return (\n      <>\n        {naked && r()}\n        {!naked && <div className=\"flax fx-guard-error\">{r()}</div>}\n      </>\n    );\n  }\n\n  const rr = () => {\n    if (!resp.result?.data) return null;\n    return props.api.reducer\n      ? props.api.reducer(resp.result?.data)\n      : resp.result?.data;\n  };\n\n  return <>{props.render(rr() as TRR, props.refreshId > 0)}</>;\n}\n\ninterface FxGuardProps<TR, TE, TRR, TER> {\n  api: FxApiRequest<TR, TE, TRR, TER>;\n  render: Renderer<TRR>;\n  error?: ErrorRenderer<TE, TER>;\n  done?: ReleaseDelegate;\n  loading?: LoadingRenderer;\n  disableLoading?: boolean;\n  naked?: boolean;\n}\n\ntype ReleaseDelegate = (succeed?: boolean) => void;\ntype ReleaseDelegateInternal = (succeed: boolean) => void;\ninterface FxGuardStates {\n  refreshId: number;\n  reloadId: number;\n  busy: boolean;\n  silent: boolean;\n  className: string | undefined;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport class FxGuard<TR = any, TE = any, TRR = TR, TER = TE> extends Component<\n  FxGuardProps<TR, TE, TRR, TER>,\n  FxGuardStates\n> {\n  constructor(props: FxGuardProps<TR, TE, TRR, TER>) {\n    super(props);\n\n    this.state = {\n      refreshId: 0,\n      reloadId: 0,\n      busy: true,\n      silent: false,\n      className: undefined,\n    };\n  }\n\n  reload(silent?: boolean, className?: string) {\n    if (this.state.busy) return;\n\n    if (silent) {\n      this.setState({\n        ...this.state,\n        reloadId: this.state.reloadId + 1,\n        busy: true,\n        silent: true,\n        className,\n      });\n      return;\n    }\n\n    this.setState({\n      ...this.state,\n      refreshId: this.state.refreshId + 1,\n      busy: true,\n      silent: false,\n      className: undefined,\n    });\n  }\n\n  releaseBusy(succeed: boolean) {\n    if (this.props.done) {\n      this.props.done(succeed);\n    }\n\n    this.setState({\n      ...this.state,\n      busy: false,\n      silent: false,\n      className: undefined,\n    });\n  }\n\n  render() {\n    const r = () => {\n      const rl = () => (\n        <>\n          {this.props.disableLoading && (\n            <>{this.props.render(null, this.state.refreshId > 0)}</>\n          )}\n          {this.props.loading && this.props.loading()}\n          {!this.props.loading && !this.props.disableLoading && (\n            <div\n              className={classNames('flax fx-guard-loader', {\n                '--silent': this.props.disableLoading,\n              })}\n            >\n              Loading ..\n            </div>\n          )}\n        </>\n      );\n\n      return (\n        <>\n          <Suspense\n            fallback={\n              <>\n                {this.props.naked && rl()}\n                {!this.props.naked && (\n                  <div\n                    className={classNames('flax fx-guard-loading', {\n                      '--silent': this.props.disableLoading,\n                    })}\n                  >\n                    {rl()}\n                  </div>\n                )}\n              </>\n            }\n          >\n            <FxGuardInner<TR, TE, TRR, TER>\n              releaseBusy={succeed => this.releaseBusy(succeed)}\n              refreshId={this.state.refreshId}\n              reloadId={this.state.reloadId}\n              api={this.props.api}\n              render={this.props.render}\n              error={this.props.error}\n              naked={this.props.naked}\n            />\n          </Suspense>\n        </>\n      );\n    };\n\n    return (\n      <>\n        {this.props.naked && r()}\n        {!this.props.naked && (\n          <div\n            className={classNames('flax fx-guard', {\n              '--loading': this.state.busy,\n              '--silent': this.state.silent,\n              [this.state.className || '--noname']: !!this.state.className,\n            })}\n          >\n            {r()}\n          </div>\n        )}\n      </>\n    );\n  }\n}\n"],"names":["classNames","args","reduce","o","e","push","Array","isArray","Object","keys","forEach","k","join","useNotification","props","container","document","getElementById","dom","createElement","id","classList","add","body","appendChild","alert","attrs","delay","wrapper","render","_react","$33fb1145c7e0ad16715a0c5c761626f1$export$FxNotification","_closeButton$","closeButton","getElementsByTagName","progressBar","progress","cb","done","setTimeout","ReactDOM","unmountComponentAtNode","remove","addEventListener","callback","elem","timerId","remaining","start","Date","getTime","anim","prev","style","width","String","animInterval","setInterval","pause","clearTimeout","clearInterval","resume","Progress","Math","min","FxNotification","type","title","message","useEffect","Fragment","className","$60dace7ba3197017125be7609e614404$export$classNames","concat","toLocaleLowerCase","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","Type","cache","NodeCache","maxKeys","resolving","resolve","reject","resp","error","_error$response","_error$response2","_error$response3","response","data","errReducer","reduced","reducer","resolvers","resolver","key","startAt","cacheKey","cacheMaxAge","set","max","splice","length","dataMapper","p","c","current","HTMLElement","value","setDefaultHeaders","headers","axios","defaults","common","assign","setBaseUrl","url","baseURL","setDefaultTransformResponse","trs","transformResponse","request","cp","PCancelable","onCancel","cancel","ct","CancelToken","source","u","query","qs","queryString","stringify","includes","lazyGroup","method","throttle","cached","get","cancelled","shouldReject","cancelToken","token","responseType","then","isCanceled","catch","err","notify","payload","notiAlert","$33fb1145c7e0ad16715a0c5c761626f1$export$useNotification","useRequest","api","reqId","setReqId","useState","setResp","busy","undefined","errorResponse","success","queues","wrapperParams","reqParams","rp","res","_err$response","_err$response2","_err$response3","_err$response4","_err$response5","status","pop","FxButton","Component","constructor","super","this","state","noti","handleClick","setState","ButtonTag","tag","onClick","disabled","children","label","lazyResponse","result","FxGuardInner","prepared","setPrepared","refreshId","reloadId","naked","req","_rp","releaseBusy","_rp2","release","lazy","rr","_resp$error","_resp$error$response","_resp$error2","_resp$error3","r","_resp$error4","_resp$result","_resp$result2","_resp$result3","FxGuard","silent","reload","succeed","rl","disableLoading","loading","--silent","Suspense","fallback","$681c65de4d2b98d4311fbc648b30a73b$var$FxGuardInner","--loading","[object Object]"],"version":3,"file":"index.module.js.map"}